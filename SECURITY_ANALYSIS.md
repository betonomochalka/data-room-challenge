# –ê–Ω–∞–ª–∏–∑ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ JWT –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏

## –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–≤—É—Ö—É—Ä–æ–≤–Ω–µ–≤—É—é —Å–∏—Å—Ç–µ–º—É –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ JWT —Ç–æ–∫–µ–Ω–æ–≤:
1. **–õ–æ–∫–∞–ª—å–Ω–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è** (HS256) - –±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏
2. **–£–¥–∞–ª–µ–Ω–Ω–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è** (fallback) - —á–µ—Ä–µ–∑ Supabase API

## ‚úÖ –ß—Ç–æ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ

### 1. –Ø–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞
```python
decoded = jwt.decode(token, jwt_secret, algorithms=['HS256'])
```
‚úÖ **–ó–∞—â–∏—Ç–∞ –æ—Ç Algorithm Confusion Attack** - —è–≤–Ω–æ —É–∫–∞–∑–∞–Ω —Ç–æ–ª—å–∫–æ HS256, –Ω–µ–ª—å–∑—è –ø–æ–¥–º–µ–Ω–∏—Ç—å –Ω–∞ "none"

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è —Ç–æ–∫–µ–Ω–∞
```python
options={'verify_exp': True}
```
‚úÖ **–ó–∞—â–∏—Ç–∞ –æ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏—Å—Ç–µ–∫—à–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤**

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ issuer
```python
token_issuer = decoded.get('iss', '')
expected_issuer = Config.SUPABASE_URL.rstrip('/')
if token_issuer and token_issuer != expected_issuer:
    if not token_issuer.startswith(expected_issuer):
        raise create_error('Invalid token issuer', 401)
```
‚úÖ **–ó–∞—â–∏—Ç–∞ –æ—Ç —Ç–æ–∫–µ–Ω–æ–≤ –æ—Ç –¥—Ä—É–≥–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤**

### 4. Fallback –º–µ—Ö–∞–Ω–∏–∑–º
‚úÖ **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** - –µ—Å–ª–∏ –ª–æ–∫–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —É–¥–∞–ª–µ–Ω–Ω–∞—è

### 5. –°–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤**

## ‚ö†Ô∏è –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 1. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Rate Limiting** üî¥ –ö–†–ò–¢–ò–ß–ù–û

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞ —Ç–æ–∫–µ–Ω–æ–≤
- –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ç—ã—Å—è—á–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –ø–æ–¥–¥–µ–ª—å–Ω—ã–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏
- Fallback –º–µ—Ö–∞–Ω–∏–∑–º –¥–µ–ª–∞–µ—Ç —É–¥–∞–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ Supabase ‚Üí –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ DoS

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```python
# –ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫
try:
    decoded_token = verify_supabase_jwt(token)
except ValueError:
    # Fallback –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
    response = supabase.auth.get_user(token)
```

**–†–µ—à–µ–Ω–∏–µ:**
```python
from functools import lru_cache
from collections import defaultdict
import time

# –ü—Ä–æ—Å—Ç–æ–π in-memory rate limiter
_failed_attempts = defaultdict(list)
MAX_FAILED_ATTEMPTS = 5
RATE_LIMIT_WINDOW = 60  # —Å–µ–∫—É–Ω–¥

def check_rate_limit(ip_address: str) -> bool:
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ rate limit –¥–ª—è IP –∞–¥—Ä–µ—Å–∞"""
    now = time.time()
    attempts = _failed_attempts[ip_address]
    
    # –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –ø–æ–ø—ã—Ç–∫–∏
    attempts[:] = [t for t in attempts if now - t < RATE_LIMIT_WINDOW]
    
    if len(attempts) >= MAX_FAILED_ATTEMPTS:
        return False
    
    attempts.append(now)
    return True
```

### 2. **–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —É—Ç–µ—á–∫–∏ –≤ –ª–æ–≥–∞—Ö** üü° –°–†–ï–î–ù–Ø–Ø

**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
print(f'Local JWT verification failed (signature mismatch), falling back to remote')
print(f'Remote token verification also failed: {e2}')
```
- –†–∞—Å–∫—Ä—ã–≤–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –ª–æ–≥–∏–∫–µ
- –ú–æ–∂–µ—Ç –ø–æ–º–æ—á—å –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫—É –ø–æ–Ω—è—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å–∏—Å—Ç–µ–º—ã

**–†–µ—à–µ–Ω–∏–µ:**
```python
# –í production –Ω–µ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –¥–µ—Ç–∞–ª–∏ –æ—à–∏–±–æ–∫
if Config.NODE_ENV == 'development':
    print(f'Local JWT verification failed, falling back to remote')
else:
    # –í production —Ç–æ–ª—å–∫–æ –æ–±—â–∏–µ –ª–æ–≥–∏
    pass
```

### 3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞—É–¥–∏—Ç–æ—Ä–∏–∏ (aud)** üü° –°–†–ï–î–ù–Ø–Ø

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –¢–æ–∫–µ–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–∞–ª–∏–¥–Ω—ã–º, –Ω–æ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–º –¥–ª—è –¥—Ä—É–≥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
- –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏, —á—Ç–æ —Ç–æ–∫–µ–Ω –≤—ã–¥–∞–Ω –∏–º–µ–Ω–Ω–æ –¥–ª—è –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```python
# –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ issuer, –Ω–æ –Ω–µ audience
decoded = jwt.decode(token, jwt_secret, algorithms=['HS256'])
```

**–†–µ—à–µ–Ω–∏–µ:**
```python
decoded = jwt.decode(
    token,
    jwt_secret,
    algorithms=['HS256'],
    options={'verify_exp': True},
    audience=Config.SUPABASE_AUDIENCE  # –ï—Å–ª–∏ Supabase –∏—Å–ø–æ–ª—å–∑—É–µ—Ç audience
)
```

### 4. **DoS —á–µ—Ä–µ–∑ Fallback –º–µ—Ö–∞–Ω–∏–∑–º** üü° –°–†–ï–î–ù–Ø–Ø

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ö–∞–∂–¥—ã–π –Ω–µ—É–¥–∞—á–Ω—ã–π –ª–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å ‚Üí —É–¥–∞–ª–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –∫ Supabase
- –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤
- –≠—Ç–æ —Å–æ–∑–¥–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ Supabase API

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```python
except ValueError:
    # Fallback –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
    response = supabase.auth.get_user(token)
```

**–†–µ—à–µ–Ω–∏–µ:**
- Rate limiting (—Å–º. –ø—É–Ω–∫—Ç 1)
- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ fallback –∑–∞–ø—Ä–æ—Å–æ–≤

### 5. **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ user_id –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º–æ–π** üü¢ –ù–ò–ó–ö–ê–Ø

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω –æ—Ç–æ–∑–≤–∞–Ω –≤ Supabase, –Ω–æ –∫–µ—à –µ—â–µ –≤–∞–ª–∏–¥–µ–Ω
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –ø–æ—Å–ª–µ –æ—Ç–∑—ã–≤–∞ —Ç–æ–∫–µ–Ω–∞

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```python
cached_user_id = get_user_id_from_cache(supabase_uid)
```

**–†–µ—à–µ–Ω–∏–µ:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å TTL –¥–ª—è –∫–µ—à–∞ (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ CACHE_TTL)
- –ü—Ä–∏ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ç–æ–∫–µ–Ω —É–¥–∞–ª–µ–Ω–Ω–æ
- –ò–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫–µ—à –ø—Ä–∏ –æ—Ç–∑—ã–≤–µ —Ç–æ–∫–µ–Ω–∞

### 6. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏–ø–∞ —Ç–æ–∫–µ–Ω–∞ (typ)** üü¢ –ù–ò–ó–ö–ê–Ø

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ù–µ—Ç —è–≤–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏, —á—Ç–æ —ç—Ç–æ –∏–º–µ–Ω–Ω–æ JWT —Ç–æ–∫–µ–Ω
- –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ –º–æ–∂–Ω–æ –ø–æ–¥–º–µ–Ω–∏—Ç—å —Ç–∏–ø

**–†–µ—à–µ–Ω–∏–µ:**
```python
# PyJWT –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ñ–æ—Ä–º–∞—Ç, –Ω–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —è–≤–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É
header = jwt.get_unverified_header(token)
if header.get('typ') != 'JWT':
    raise create_error('Invalid token type', 401)
```

### 7. **–°–ª–∞–±–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ issuer** üü¢ –ù–ò–ó–ö–ê–Ø

**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
if not token_issuer.startswith(expected_issuer):
```
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `startswith` –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º –º—è–≥–∫–∏–º
- –ù–∞–ø—Ä–∏–º–µ—Ä, `https://evil.com/https://your-supabase.com` –ø—Ä–æ–π–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É

**–†–µ—à–µ–Ω–∏–µ:**
```python
# –ë–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
if token_issuer != expected_issuer and token_issuer != f"{expected_issuer}/auth/v1":
    raise create_error('Invalid token issuer', 401)
```

### 8. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ —Å–æ–∑–¥–∞–Ω–∏—è (iat)** üü¢ –ù–ò–ó–ö–ê–Ø

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏, —á—Ç–æ —Ç–æ–∫–µ–Ω –Ω–µ –±—ã–ª —Å–æ–∑–¥–∞–Ω –≤ –±—É–¥—É—â–µ–º
- –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞ —Ç–æ–∫–µ–Ω–∞

**–†–µ—à–µ–Ω–∏–µ:**
```python
decoded = jwt.decode(
    token,
    jwt_secret,
    algorithms=['HS256'],
    options={
        'verify_exp': True,
        'verify_iat': True,  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ —Å–æ–∑–¥–∞–Ω–∏—è
        'leeway': 60  # –î–æ–ø—É—Å—Ç–∏–º–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
    }
)

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞
if 'iat' in decoded:
    max_age = 3600 * 24  # 24 —á–∞—Å–∞
    if time.time() - decoded['iat'] > max_age:
        raise create_error('Token too old', 401)
```

## üìã –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º

### –ö—Ä–∏—Ç–∏—á–Ω—ã–µ (–∏—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ):
1. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å Rate Limiting –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞
2. ‚úÖ –£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ (–Ω–µ —Ä–∞—Å–∫—Ä—ã–≤–∞—Ç—å –¥–µ—Ç–∞–ª–∏ –≤ production)

### –í–∞–∂–Ω—ã–µ (–∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è):
3. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É audience (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Supabase)
4. ‚úÖ –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å fallback –º–µ—Ö–∞–Ω–∏–∑–º (rate limit + –∫–µ—à –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫)

### –ñ–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ (—É–ª—É—á—à–µ–Ω–∏—è):
5. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É iat –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞ —Ç–æ–∫–µ–Ω–∞
6. ‚úÖ –£–ª—É—á—à–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É issuer (–±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∞—è)
7. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

## üîí –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 1. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç–∏–Ω–≥
```python
# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
if failed_attempts > threshold:
    send_security_alert(f"Suspicious activity from {ip_address}")
```

### 2. IP Whitelisting (–¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π)
```python
ALLOWED_IPS = os.getenv('ALLOWED_IPS', '').split(',')
if request.remote_addr not in ALLOWED_IPS:
    raise create_error('Access denied', 403)
```

### 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–æ–ª–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
- –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ RS256 (–∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ)
- –¢—Ä–µ–±—É–µ—Ç JWKS endpoint –æ—Ç Supabase

### 4. –†–µ–≥—É–ª—è—Ä–Ω–∞—è —Ä–æ—Ç–∞—Ü–∏—è —Å–µ–∫—Ä–µ—Ç–Ω—ã—Ö –∫–ª—é—á–µ–π
- –ü–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–æ—Ç–∞—Ü–∏—é –∫–ª—é—á–µ–π
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–ª—é—á–µ–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –¥–ª—è –ø–ª–∞–≤–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏

## üìä –û—Ü–µ–Ω–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —É—Ä–æ–≤–Ω—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞: 7/10**

‚úÖ **–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:**
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è
- Fallback –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏

‚ö†Ô∏è **–°–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:**
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ rate limiting
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —É—Ç–µ—á–∫–∏ –≤ –ª–æ–≥–∞—Ö
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ audience

## üéØ –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

1. **–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ:** –î–æ–±–∞–≤–∏—Ç—å rate limiting
2. **–í —Ç–µ—á–µ–Ω–∏–µ –Ω–µ–¥–µ–ª–∏:** –£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
3. **–í —Ç–µ—á–µ–Ω–∏–µ –º–µ—Å—è—Ü–∞:** –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É audience –∏ —É–ª—É—á—à–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
